<!DOCTYPE html>
<html lang="en">
<head>
	<title>UMBC Library Catalog</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
	<link rel="stylesheet" type="text/css" href="index.css">
<script>
		
		var loginStatus = false;
		var counter = 1;
		var sStat = false;
		var libStat = false;
		var mainStat = false;

		function addMore(){
			var max = 3;
			if(counter < max){
				counter++;
				var newSearchBar = document.createElement('div');
				newSearchBar.setAttribute('class', 'form-group row inputDiv');
				document.getElementById('search').appendChild(newSearchBar);
			
				var newInnerBar = document.createElement('div');
				newInnerBar.setAttribute('class', 'form-group col-md-2');
				newSearchBar.appendChild(newInnerBar);

				var newSelect = document.createElement('select');
				newSelect.setAttribute('class', 'form-control typeSelect');
				newSelect.setAttribute('name', 'type');
				newInnerBar.appendChild(newSelect);

				var newTitleSel = document.createElement('option');
				newTitleSel.innerHTML = "Title";
				newSelect.appendChild(newTitleSel);

				var newAuthorSel = document.createElement('option');
				newAuthorSel.innerHTML = "Author";
				newSelect.appendChild(newAuthorSel);

				var newYearSel = document.createElement('option');
				newYearSel.innerHTML = "Year";
				newSelect.appendChild(newYearSel);

				var newISBNSel = document.createElement('option');
				newISBNSel.innerHTML = "ISBN";
				newSelect.appendChild(newISBNSel);

				var newKeyDiv = document.createElement('div');
				newKeyDiv.setAttribute('class', 'form-group col-md-10');
				newSearchBar.appendChild(newKeyDiv);

				var newKey = document.createElement('input');
				newKey.setAttribute('type', 'text');
				newKey.setAttribute('class', 'form-control searchBar');
				newKey.setAttribute('placeholder', 'Keywords');
				newKey.setAttribute('name', 'key');
				newKeyDiv.appendChild(newKey);
			}
			else{
				alert("Reaching maximum amount of keyword");
			}
		}

		
		function deleteBar(){
			if(counter == 1){
				alert("Reaching minium amount of keyword");
				return;
			}
			var remove = document.getElementsByClassName('inputDiv');
			remove[counter-1].parentNode.removeChild(remove[counter-1]);	
			counter--;
		}
		
		function login(){
			loginStatus = true;
			
			var accLink = document.createElement('li');
			accLink.setAttribute('class','nav-item');

			var accForm = document.createElement('form');
			accForm.setAttribute('id','accForm');
			accForm.setAttribute('action','account.html');
			accForm.setAttribute('method','GET');

			var accValue = document.createElement('input');
			accValue.setAttribute('name','status');
			accValue.style.display="none";

			if(sStat == true)
				accValue.setAttribute('value','std');
			else if(libStat == true)
				accValue.setAttribute('value','lib');
			else if(mainStat == true)
				accValue.setAttribute('value','main');

			accForm.appendChild(accValue);

			var acc = document.createElement('a');
			acc.setAttribute('class','nav-link');
			acc.setAttribute('href','');
			acc.setAttribute('onclick','accDir()');
			acc.innerHTML=acc.innerHTML+"Account";		
			accForm.appendChild(acc);

			accLink.appendChild(accForm);

			document.getElementById('menuList').appendChild(accLink);

			document.getElementById("logLink").innerHTML="Sign Out";
			document.getElementById("logLink").href="";
			document.getElementById("logLink").setAttribute("onclick","logout()");
		}

		function logout(){
			var c = confirm("Do you want to sign out?");
			if(c==true){
				loginStatus = false;
				sStat = false;
				libStat = false;
				mainStat = false;
				location.replace("index.html");
			}
		}
		
		function checkHome(){
			if(login == true){
				document.getElementById("home").href="";
			}
			else{
				document.getElementById("home").href="index.html";
			}
		}

		function clearKey(){
			var x = document.getElementsByClassName('searchBar');
			x[0].value = '';
			if(counter > 1){
				var i;
				for(i = counter; i > 1; i--){
					var remove = document.getElementsByClassName('inputDiv');
					remove[counter-1].parentNode.removeChild(remove[counter-1]);	
					counter--;
				}
			}
		}
		
		function accDir(){
			document.getElementById("accForm").submit();
		}

		function check(){
			var x = document.getElementsByClassName('searchBar');
			var i;

			for(i = 0; i < counter; i++){
				if(x[i].value==''){
					alert("search bar cannot be empty!");
					return false;
				}
			}


			var num = document.getElementById('number');
			num.setAttribute('value',counter);

			if(loginStatus == true){
				if(sStat == true){
					var acc = document.getElementById('accStat');
					acc.setAttribute('value',"std");
				}
				else if(libStat == true){
					var acc = document.getElementById('accStat');
					acc.setAttribute('value',"lib");
				}
				else if(mainStat == true){
					var acc = document.getElementById('accStat');
					acc.setAttribute('value',"main");
				}
			}else{
				var acc = document.getElementById('accStat');
				acc.setAttribute('value',"none");
			}

			return true;
		}
	</script>
</head>
<body>
	<nav class="navbar navbar-expand-md bg-dark navbar-dark">
		<a class="navbar-brand" href="" id="home" onclick="checkHome">Home</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="collapsibleNavbar">
			<ul class="navbar-nav" id="menuList">
				<li class="nav-item">
					<a class="nav-link" href="login.html" id="logLink">Sign in</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="help.html">Help</a>
				</li>
			</ul>
		</div>  
	</nav>

	<div style="height: 100vh">
    		<div class="container h-100">
        		<div class="jumbotron">
				<img src="UMBC logo.png" alt="UMBC logo" style="width:100px;height:20px;">
				<h1 style = "text-align:center;"> UMBC Library Catalog</h1>
				<p class="text-center">Welcome come to UMBC Library</p>
				<form style="text-align:center;" action="search.html" onsubmit="return check()" method="GET">
					<input type="text" style="display:none;" name="num" id="number"></input>
					<input type="text" style="display:none;" name="acc" id="accStat"></input>
					<div id='search'>
						<div class="form-group row  inputDiv">
							<div class="form-group col-md-2">
   								<select class="form-control typeSelect" name="type">
     									<option>Title</option>
									<option>Author</option>
									<option>Year</option>
									<option>ISBN</option>
    								</select>
							</div>
							<div class="form-group col-md-10">
    								<input type="text" class="form-control searchBar" placeholder="Keywords" name="key">
    							</div>
  						</div>
					</div>
					<button type="sumbit" class="btn btn-dark">Search</button>
					<button type="button" onclick="clearKey()" class="btn btn-dark">Clear</button>
					<button type="button" onclick="addMore();" class="btn btn-dark" >Add more keyword</button>
					<button type="button" onclick="deleteBar();" class="btn btn-dark">Delete the keyword</button>
				</form>
			</div>
			<br>
		</div>
	</div>

	<script>
		function checkLogin(){
			var parameters = location.search.substring(1).split("&");
			var temp = parameters[0].split("=");
			var l = unescape(temp[1]);
			if(l == "std"){
				sStat = true;
				login();
			}
			else if(l == "lib"){
				libStat = true;
				login();

			}
			else if(l == "main"){
				mainStat = true;
				login();

			}
		}
		checkLogin();
	</script>
</body>
</html>