<!DOCTYPE html>
<html lang="en">
<head>
	<title>Search</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
	<link rel="stylesheet" href="search.css">
	<script>

		var findBook1 = false;
		var findBook2 = false;
		var findBook3 = false;

		var book1={
			title: "book1",
			author: "author1",
			year:"1991",
			ISBN:"111-2-33-444444-5",
		};
		var book2={
			title: "book2",
			author: "author2",
			year:"1992",
			ISBN:"666-7-88-999999-1"
		};
		var book3={
			title: "book3",
			author: "author3",
			year:"1993",
			ISBN:"222-1-44-888888-9"
		};
		function showBook(){

			if(findBook1 == true){
				var book1title = document.createElement('td');
				book1title.innerHTML = book1title.innerHTML + book1.title;
				document.getElementById('book1').appendChild(book1title);
				
				var book1author = document.createElement('td');
				book1author.innerHTML = book1author.innerHTML + book1.author;
				document.getElementById('book1').appendChild(book1author);
				
				var book1year = document.createElement('td');
				book1year.innerHTML = book1year.innerHTML + book1.year;
				document.getElementById('book1').appendChild(book1year);
				
				var book1ISBN = document.createElement('td');
				book1ISBN.innerHTML = book1ISBN.innerHTML + book1.ISBN;
				document.getElementById('book1').appendChild(book1ISBN);
				var book1Button = document.createElement("button");
				book1Button.setAttribute('class',"btn btn-dark");
				book1Button.setAttribute('onclick',"JavaScript:alert('Adding to bookshelf is successful!')");
				book1Button.innerHTML = "add to favourite";
				var book1Buttontd = document.createElement("td");
				book1Buttontd.appendChild(book1Button);
				document.getElementById('book1').appendChild(book1Buttontd);
				
			}
			if(findBook2 == true){
				var book2Link = document.createElement('a');
				book2Link.setAttribute('href','book2.html');
				var book2title = document.createElement('td');
				book2title.innerHTML = book2title.innerHTML + book2.title;
				document.getElementById('book2').appendChild(book2title);
				
				var book2author = document.createElement('td');
				book2author.innerHTML = book2author.innerHTML + book2.author;
				document.getElementById('book2').appendChild(book2author);
				
				var book2year = document.createElement('td');
				book2year.innerHTML = book2year.innerHTML + book2.year;
				document.getElementById('book2').appendChild(book2year);
				
				var book2ISBN = document.createElement('td');
				book2ISBN.innerHTML = book2ISBN.innerHTML + book2.ISBN;
				document.getElementById('book2').appendChild(book2ISBN);
				
				var book2Button = document.createElement("button");
				book2Button.setAttribute('class',"btn btn-dark");
				book2Button.setAttribute('onclick',"JavaScript:alert('Adding to bookshelf is successful!')");
				book2Button.innerHTML = "add to favourite";
				var book2Buttontd = document.createElement("td");
				book2Buttontd.appendChild(book2Button);
				document.getElementById('book2').appendChild(book2Buttontd);
				
			}

			if(findBook3 == true){
				var book3title = document.createElement('td');
				book3title.innerHTML = book3title.innerHTML + book3.title;
				document.getElementById('book3').appendChild(book3title);
				
				var book3author = document.createElement('td');
				book3author.innerHTML = book3author.innerHTML + book3.author;
				document.getElementById('book3').appendChild(book3author);
				
				var book3year = document.createElement('td');
				book3year.innerHTML = book3year.innerHTML + book3.year;
				document.getElementById('book3').appendChild(book3year);
				
				var book3ISBN = document.createElement('td');
				book3ISBN.innerHTML = book3ISBN.innerHTML + book3.ISBN;
				document.getElementById('book3').appendChild(book3ISBN);
				
				var book3Button = document.createElement("button");
				book3Button.setAttribute('class',"btn btn-dark");
				book3Button.setAttribute('onclick',"JavaScript:alert('Adding to bookshelf is successful!')");
				book3Button.innerHTML = "add to favourite";
				var book3Buttontd = document.createElement("td");
				book3Buttontd.appendChild(book3Button);
				document.getElementById('book3').appendChild(book3Buttontd);
			}

			if(findBook1 == false && findBook2 == false && findBook3 == false){
				var remove = document.getElementById('bar');
				remove.parentNode.removeChild(remove);
				var noFound = document.createElement('h1');
				noFound.innerHTML = "sorry, there is no match book.";
				document.getElementById('result').appendChild(noFound);
			}

		}

		var loginStatus = false;
		var sStat = false;
		var libStat = false;
		var mainStat = false;

		function backIndex(){
			if(loginStatus == true)
				checkHome();
			else{
				location.replace("index.html");
			}
		}

		function login(){
			loginStatus = true;
			
			var accLink = document.createElement('li');
			accLink.setAttribute('class','nav-item');

			var accForm = document.createElement('form');
			accForm.setAttribute('id','accForm');
			accForm.setAttribute('action','account.html');
			accForm.setAttribute('method','GET');

			var accValue = document.createElement('input');
			accValue.setAttribute('name','status');
			accValue.style.display="none";

			if(sStat == true)
				accValue.setAttribute('value','std');
			else if(libStat == true)
				accValue.setAttribute('value','lib');
			else if(mainStat == true)
				accValue.setAttribute('value','main');

			accForm.appendChild(accValue);

			var acc = document.createElement('a');
			acc.setAttribute('class','nav-link');
			acc.setAttribute('href','');
			acc.setAttribute('onclick','accDir()');
			acc.innerHTML=acc.innerHTML+"Account";		
			accForm.appendChild(acc);

			accLink.appendChild(accForm);

			document.getElementById('menuList').appendChild(accLink);

			document.getElementById("logLink").innerHTML="Sign Out";
			document.getElementById("logLink").href="";
			document.getElementById("logLink").setAttribute("onclick","logout()");
		}

		function logout(){
			var c = confirm("Do you want to sign out?");
			if(c==true){
				loginStatus = false;
				sStat = false;
				libStat = false;
				mainStat = false;
				location.replace("index.html");
			}
		}

		function accDir(){
			document.getElementById("accForm").submit();
		}

		function checkHome(){
			if(loginStatus == true){
				if(sStat == true)
					document.getElementById("return").value = "std";
				if(libStat == true)
					document.getElementById("return").value = "lib";
				if(mainStat == true)
					document.getElementById("return").value = "main";
				document.getElementById("mainForm").submit();
			}
			else{
				document.getElementById("home").href="index.html";
			}
		}

		function toHelp(){
			if(loginStatus == false){
				document.getElementById('homeId').value = "none";
			}else{
				if(sStat == true)
					document.getElementById('homeId').value = "std";
				if(libStat == true)
					document.getElementById('homeId').value = "lib";
			}

			document.getElementById("helpForm").submit();
		}

	</script>
</head>
<body>
	<nav class="navbar navbar-expand-md bg-dark navbar-dark">
   		<form action="index.html" method="GET" id="mainForm">
			<input style="display:none;" name="confirm" id="return"> </input>
   			<a class="navbar-brand" href="index.html" onclick="checkHome()">Home</a>
		</form>
   		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
   			<span class="navbar-toggler-icon"></span>
   		</button>
   		<div class="collapse navbar-collapse" id="collapsibleNavbar">
   		<ul class="navbar-nav" id="menuList">
			<li class="nav-item">
					<a class="nav-link" href="login.html" id="logLink">Sign in</a>
				</li>
   			<li class="nav-item" id="helpLi">
					<form action="help.html" method="GET" id="helpForm">
						<input style="display:none;" name="confirm" id ="homeId"> </input>
   						<a class="nav-link" href="help.html" onclick="toHelp()">Help</a>
					</form>
				</li>
   		</ul>
   		</div>  
	</nav>

	<div style="height: 100vh">
		<div class="container h-100">
        	<div class="jumbotron">
        		<img src="UMBC logo.png" alt="UMBC logo" style="width:100px;height:20px;">
        		<div style="text-align:center;">
        			<h1>Results:</h1>
        		</div>
        		<table class="table table-hover">
  				<thead>
    				<tr id = "bar">
     				<th scope="col">Title</th>
     				<th scope="col">Author</th>
      				<th scope="col">Year</th>
      				<th scope="col">ISBN</th>
    				</tr>
  				</thead>
  				<tbody>
    				<tr id="book1">
    				</tr>
    				<tr id="book2">
    				</tr>
    				<tr id="book3">
    				</tr>
  				</tbody>
				</table>
        		<div id="result"></div>
<button class="btn btn-dark" onclick="backIndex()">Back</button>
    		</div>
		</div>
	</div>
	<div id="result" style="text-align=center;">
		
		
	</div>
	<script>
	function checkUrl(){
		var parameters = location.search.substring(1).split("&");
			var numString = parameters[0].split("=");
			var num = unescape(numString[1]);
			var inputNum = num * 2;
			
			var accString = parameters[1].split("=");
			var acc = unescape(accString[1]);

			if(acc == "std"){
				sStat = true;
				login();
			}
			else if(acc == "lib"){
				libStat = true;
				login();

			}
			else if(acc == "main"){
				mainStat = true;
				login();

			}

			var i;
			for(i = 2; i <= inputNum; i = i + 2){
				var temp1 = parameters[i].split("=");
				var type = unescape(temp1[1]);
				
				var temp2 = parameters[i+1].split("=");
				var key = unescape(temp2[1]);

				if(type == "Title"){
					if(key == book1.title)
						findBook1 = true;
					else if(key == book2.title)
						findBook2 = true;
					else if(key == book3.title)
						findBook3 = true;
				}
				if(type == "Author"){
					if(key == book1.author)
						findBook1 = true;
					else if(key == book2.author)
						findBook2 = true;
					else if(key == book3.author)
						findBook3 = true;
				}
				if(type == "Year"){
					if(key == book1.year)
						findBook1 = true;
					else if(key == book2.year)
						findBook2 = true;
					else if(key == book3.year)
						findBook3 = true;
				}
				if(type == "ISBN"){
					if(key == book1.ISBN)
						findBook1 = true;
					else if(key == book2.ISBN)
						findBook2 = true;
					else if(key == book3.ISBN)
						findBook3 = true;
				}
			}
		}

		checkUrl();
		showBook();

	</script>
	</body>
</html>